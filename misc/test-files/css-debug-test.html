<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSS Specificity Test</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: system-ui, sans-serif;
            background: #f0f0f0;
        }
        
        .test-panel {
            position: fixed;
            top: 20px;
            left: 20px;
            background: black;
            color: white;
            padding: 20px;
            border-radius: 8px;
            z-index: 3000;
            max-width: 500px;
            font-size: 11px;
        }
        
        .test-btn {
            margin: 2px;
            padding: 5px 10px;
            border: none;
            border-radius: 4px;
            background: #333;
            color: white;
            cursor: pointer;
            font-size: 11px;
        }
        
        .test-btn.active {
            background: #EBC533;
            color: black;
        }
        
        .css-debug {
            margin: 10px 0;
            font-family: monospace;
            background: #222;
            padding: 10px;
            border-radius: 4px;
            font-size: 10px;
            max-height: 300px;
            overflow-y: auto;
        }
    </style>
    <link rel="stylesheet" href="css/utilities/variables.css">
    <link rel="stylesheet" href="css/components/mascot.css">
    <link rel="stylesheet" href="css/components/mascot-environment.css">
</head>
<body>
    <div class="test-panel">
        <h3>CSS Debug Test</h3>
        <div>
            <button class="test-btn" data-state="creating">Creating</button>
            <button class="test-btn" data-state="thinking">Thinking</button>
            <button class="test-btn" data-state="coffee">Coffee</button>
        </div>
        <div class="css-debug" id="cssDebug">
            Click a state button to debug...
        </div>
    </div>

    <script type="module">
        import { DesignerMascot } from './js/modules/mascot.js';
        
        let mascot = null;
        
        function debugElementStyles(state) {
            const envEl = document.querySelector('.mascot-environment');
            const debugEl = document.getElementById('cssDebug');
            
            if (!envEl) {
                debugEl.textContent = 'Environment element not found!';
                return;
            }
            
            let debug = `ENV ELEMENT DEBUG (${state}):\n\n`;
            debug += `Environment classes: ${envEl.className}\n\n`;
            
            // Check container
            const container = envEl.querySelector(`.env-${state}`);
            if (container) {
                const containerStyle = getComputedStyle(container);
                debug += `Container .env-${state}:\n`;
                debug += `  display: ${containerStyle.display}\n`;
                debug += `  visibility: ${containerStyle.visibility}\n\n`;
                
                // Check elements inside
                const elements = container.querySelectorAll('.env-element');
                debug += `Elements in container: ${elements.length}\n`;
                
                elements.forEach((el, i) => {
                    const style = getComputedStyle(el);
                    debug += `  Element ${i} (${el.className}):\n`;
                    debug += `    opacity: ${style.opacity}\n`;
                    debug += `    transform: ${style.transform}\n`;
                    debug += `    display: ${style.display}\n`;
                    debug += `    position: ${style.position}\n`;
                    if (el.textContent) debug += `    content: "${el.textContent}"\n`;
                    debug += `\n`;
                });
            } else {
                debug += `Container .env-${state} not found!\n`;
            }
            
            debugEl.textContent = debug;
        }
        
        // Initialize mascot
        try {
            mascot = new DesignerMascot();
            console.log('ðŸŽ­ CSS Debug test initialized');
            
            setTimeout(() => {
                debugElementStyles('idle');
            }, 1000);
        } catch (error) {
            console.error('Mascot error:', error);
            document.getElementById('cssDebug').textContent = `Error: ${error.message}`;
        }
        
        // Test buttons
        document.querySelectorAll('.test-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const state = btn.dataset.state;
                
                // Update active button
                document.querySelectorAll('.test-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                
                if (mascot) {
                    console.log(`Setting state to: ${state}`);
                    mascot.setState(state);
                    setTimeout(() => debugElementStyles(state), 200);
                }
            });
        });
    </script>
</body>
</html>
