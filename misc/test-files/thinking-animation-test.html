<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Thinking Animation Test</title>
    <style>
        body {
            margin: 0;
            padding: 40px;
            font-family: system-ui, sans-serif;
            background: white;
            min-height: 100vh;
        }
        
        .test-controls {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 20px;
            border-radius: 8px;
            z-index: 2000;
        }
        
        .test-btn {
            display: block;
            margin: 10px 0;
            padding: 10px 15px;
            background: #333;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            width: 120px;
        }
        
        .test-btn:hover {
            background: #555;
        }
        
        .test-btn.active {
            background: #EBC533;
            color: #333;
        }
        
        .info {
            margin: 20px 0;
            padding: 15px;
            background: #f0f0f0;
            border-radius: 4px;
            max-width: 600px;
        }
        
        .timing-info {
            font-size: 12px;
            color: #666;
            margin-top: 10px;
        }
    </style>
    <link rel="stylesheet" href="css/utilities/variables.css">
    <link rel="stylesheet" href="css/components/mascot.css">
    <link rel="stylesheet" href="css/components/mascot-environment.css">
</head>
<body>
    <div class="test-controls">
        <h3>Thinking Animation Test</h3>
        <button class="test-btn" data-state="idle">Idle</button>
        <button class="test-btn" data-state="thinking">Thinking</button>
        <div class="timing-info">
            Current: <span id="currentState">idle</span><br>
            Timer: <span id="timer">0s</span>
        </div>
    </div>
    
    <div class="info">
        <h2>Enhanced Thinking Animation Test</h2>
        <p><strong>What to expect:</strong></p>
        <ul>
            <li>‚ú® <strong>Thought bubble:</strong> Now has glow/shadow for visibility on white background</li>
            <li>‚ùì <strong>Question mark:</strong> Animates inside bubble for first 5 seconds</li>
            <li>üí° <strong>Light bulb:</strong> Replaces question mark for final 5 seconds</li>
            <li>‚è±Ô∏è <strong>Total duration:</strong> 10 seconds, then returns to idle</li>
        </ul>
        
        <p><strong>Test Instructions:</strong></p>
        <ol>
            <li>Click "Thinking" to trigger the animation</li>
            <li>Watch the bottom-right corner</li>
            <li>Observe the sequence: bubble appears ‚Üí question mark (5s) ‚Üí lightbulb (5s) ‚Üí return to idle</li>
        </ol>
    </div>

    <script type="module">
        import { DesignerMascot } from './js/modules/mascot.js';
        
        let mascot = null;
        let timer = 0;
        let timerInterval = null;
        
        // Initialize mascot
        try {
            mascot = new DesignerMascot();
            console.log('üé≠ Thinking animation test initialized');
        } catch (error) {
            console.error('Mascot error:', error);
        }
        
        // Update timer display
        function startTimer() {
            timer = 0;
            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                timer++;
                document.getElementById('timer').textContent = `${timer}s`;
                
                // Stop timer at 10 seconds
                if (timer >= 10) {
                    clearInterval(timerInterval);
                }
            }, 1000);
        }
        
        // Update current state display
        function updateStateDisplay(state) {
            document.getElementById('currentState').textContent = state;
            
            // Update active button
            document.querySelectorAll('.test-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.state === state);
            });
            
            if (state === 'thinking') {
                startTimer();
            }
        }
        
        // Test buttons
        document.querySelectorAll('.test-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const state = btn.dataset.state;
                
                if (mascot) {
                    mascot.setState(state);
                    updateStateDisplay(state);
                    console.log(`üé≠ Manually set state to: ${state}`);
                } else {
                    console.error('Mascot not available!');
                }
            });
        });
        
        // Monitor mascot state changes
        if (mascot) {
            const originalSetState = mascot.setState.bind(mascot);
            mascot.setState = function(newState, immediate) {
                const result = originalSetState(newState, immediate);
                updateStateDisplay(newState);
                return result;
            };
        }
    </script>
</body>
</html>
